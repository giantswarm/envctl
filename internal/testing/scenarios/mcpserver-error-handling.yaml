name: "mcpserver-error-handling-scenarios"
category: "behavioral"
concept: "mcpserver"
description: "Scenarios for error handling in MCPServer management based on the correct data model"
tags: ["mcpserver", "error-handling", "core-api"]
timeout: "5m"

steps:
- id: "create-mcpserver-invalid-yaml"
  description: "Attempt to create an MCPServer with invalid YAML syntax"
  tool: "core_mcpserver_create"
  args:
    yaml: "name: bad-server: 'oh no"
  expected:
    success: false
    error_contains: ["invalid YAML"]

- id: "create-mcpserver-missing-name"
  description: "Attempt to create an MCPServer with a missing 'name' field"
  tool: "core_mcpserver_create"
  args:
    yaml: |
      type: "localCommand"
      command: ["echo", "hello"]
  expected:
    success: false
    error_contains: ["name is required"]

- id: "create-mcpserver-invalid-type"
  description: "Attempt to create an MCPServer with an invalid 'type' field"
  tool: "core_mcpserver_create"
  args:
    yaml: |
      name: "invalid-type-server"
      type: "not-a-real-type"
  expected:
    success: false
    error_contains: ["invalid mcpserver type: not-a-real-type"]

- id: "create-local-command-server-missing-command"
  description: "Attempt to create a 'localCommand' server without a 'command'"
  tool: "core_mcpserver_create"
  args:
    yaml: |
      name: "no-command-server"
      type: "localCommand"
  expected:
    success: false
    error_contains: ["'command' is required for localCommand type"]

- id: "create-container-server-missing-image"
  description: "Attempt to create a 'container' server without an 'image'"
  tool: "core_mcpserver_create"
  args:
    yaml: |
      name: "no-image-server"
      type: "container"
  expected:
    success: false
    error_contains: ["'image' is required for container type"]

- id: "get-non-existent-mcpserver"
  description: "Attempt to get an MCPServer that does not exist"
  tool: "core_mcpserver_get"
  args:
    name: "non-existent-mcpserver"
  expected:
    success: false
    error_contains: ["not found"]

- id: "update-non-existent-mcpserver"
  description: "Attempt to update a non-existent MCPServer"
  tool: "core_mcpserver_update"
  args:
    name: "non-existent-mcpserver"
    yaml: |
      name: "non-existent-mcpserver"
      type: "localCommand"
      command: ["echo", "update"]
  expected:
    success: false
    error_contains: ["not found"]

- id: "delete-non-existent-mcpserver"
  description: "Attempt to delete a non-existent MCPServer"
  tool: "core_mcpserver_delete"
  args:
    name: "non-existent-mcpserver"
  expected:
    success: false
    error_contains: ["not found"]

- id: "unregister-non-existent-mcpserver"
  description: "Attempt to unregister an MCPServer that does not exist"
  tool: "core_mcpserver_unregister"
  args:
    name: "non-existent-mcpserver"
  expected:
    success: false
    error_contains: ["not found"]

- id: "check-availability-for-non-existent-mcpserver"
  description: "Check availability for an MCPServer that does not exist"
  tool: "core_mcpserver_available"
  args:
    name: "non-existent-mcpserver"
  expected:
    success: false
    error_contains: ["not found"] 