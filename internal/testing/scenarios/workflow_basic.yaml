name: "workflow-basic-operations"
category: "behavioral"
concept: "workflow"
description: "Basic Workflow management operations - create, validate, list, delete"
tags: ["basic", "crud", "workflow"]
timeout: "3m"

steps:
  - id: "list-initial-workflows"
    description: "Get initial list of workflows to establish baseline"
    tool: "core_workflow_list"
    args:
      include_system: true
    expected:
      success: true
    timeout: "30s"

  - id: "validate-test-workflow-definition"
    description: "Validate a test workflow definition before creating it"
    tool: "core_workflow_validate"
    args:
      yaml_definition: |
        name: test-basic-workflow
        description: "Test workflow for behavioral testing"
        input_schema:
          type: object
          properties:
            target_service:
              type: string
              description: "Target service name"
            operation:
              type: string
              default: "status"
              description: "Operation to perform"
          required:
            - target_service
        steps:
          - id: check_service_status
            tool: core_service_status
            args:
              label: "{{ .target_service }}"
          - id: list_all_services
            tool: core_service_list
            args: {}
    expected:
      success: true
      contains: ["valid", "definition"]
    timeout: "30s"

  - id: "create-test-workflow"
    description: "Create a new test workflow with basic configuration"
    tool: "core_workflow_create"
    args:
      yaml_definition: |
        name: test-basic-workflow
        description: "Test workflow for behavioral testing"
        input_schema:
          type: object
          properties:
            target_service:
              type: string
              description: "Target service name"
            operation:
              type: string
              default: "status"
              description: "Operation to perform"
          required:
            - target_service
        steps:
          - id: check_service_status
            tool: core_service_status
            args:
              label: "{{ .target_service }}"
          - id: list_all_services
            tool: core_service_list
            args: {}
    expected:
      success: true
      contains: ["created successfully"]
    timeout: "1m"

  - id: "verify-workflow-created"
    description: "Verify the workflow was created and retrieve its details"
    tool: "core_workflow_get"
    args:
      name: "test-basic-workflow"
    expected:
      success: true
      contains: ["test-basic-workflow", "Test workflow for behavioral testing"]
    timeout: "30s"

  - id: "list-workflows-with-new"
    description: "List workflows to verify our new one appears"
    tool: "core_workflow_list"
    args:
      include_system: true
    expected:
      success: true
      contains: ["test-basic-workflow"]
    timeout: "30s"

  - id: "get-workflow-specification"
    description: "Get the workflow specification format for reference"
    tool: "core_workflow_spec"
    args:
      format: "schema"
    expected:
      success: true
      contains: ["schema", "workflow"]
    timeout: "30s"

cleanup:
  - id: "delete-test-workflow"
    description: "Clean up by deleting the test workflow"
    tool: "core_workflow_delete"
    args:
      name: "test-basic-workflow"
    expected:
      success: true
      contains: ["deleted successfully", "test-basic-workflow"]
    timeout: "30s"

  - id: "verify-workflow-deleted"
    description: "Verify the workflow was completely removed"
    tool: "core_workflow_get"
    args:
      name: "test-basic-workflow"
    expected:
      success: false
      error_contains: ["not found"]
    timeout: "30s" 