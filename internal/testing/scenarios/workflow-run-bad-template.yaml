name: "workflow-run-bad-template"
category: "behavioral"
concept: "workflow"
description: "Tests running a workflow with a bad template."
tags: ["workflow", "run", "template", "error-handling", "core-api"]
timeout: "1m"

pre_configuration:
  workflows:
  - name: "bad-template-workflow"
    config:
      name: "bad-template-workflow"
      steps:
        - id: "bad-step"
          tool: "x_echo-provider_echo"
          args: { text: "{{ .context.non_existent_value }}" }
  mcp_servers:
  - name: "echo-provider"
    config:
      tools:
      - name: "echo"
        input_schema: { type: "object", properties: { text: { type: "string" } } }
        responses: [ { response: { said: "{{ .text }}" } } ]
steps:
- id: "run-bad-template"
  description: "Run a workflow with a step that references a non-existent context value"
  tool: "workflow_bad-template-workflow"
  args: {}
  expected:
    success: false
    error_contains: ["failed to render arguments", "non_existent_value"] 